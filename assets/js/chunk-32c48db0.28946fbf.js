(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32c48db0"],{"0eeb":function(e,t,s){},"2ca0":function(e,t,s){"use strict";var n=s("23e7"),i=s("06cf").f,a=s("50c4"),r=s("5a34"),o=s("1d80"),c=s("ab13"),d=s("c430"),u="".startsWith,l=Math.min,_=c("startsWith"),m=!d&&!_&&!!function(){var e=i(String.prototype,"startsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!m&&!_},{startsWith:function(e){var t=String(o(this));r(e);var s=a(l(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return u?u.call(t,n,s):t.slice(s,s+n.length)===n}})},"36e5":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"disable_selection white-card-container",on:{click:e.toggleSelect}},[s("md-card",{staticClass:"white-card",attrs:{"md-with-hover":""}},[s("div",{staticClass:"md-title"},[e._v(e._s(e.displayedText))]),s("div",{staticClass:"md-subhead evenly-spaced"},[s("span",[e._v(e._s(e.card_data.icon)+" ")]),s("span",[e._v(e._s(e.card_data.deck))])])])],1)},i=[],a=(s("ac1f"),s("5319"),{data:function(){return{}},components:{},methods:{toggleSelect:function(){this.on_clicked_callback&&this.on_clicked_callback(this.card_data,!0)}},props:{card_data:{required:!0},on_clicked_callback:{default:null}},computed:{displayedText:function(){return this.card_data.text.replace("_","_____")}}}),r=a,o=(s("7e34"),s("2877")),c=Object(o["a"])(r,n,i,!1,null,"05736f80",null);t["a"]=c.exports},"3a39":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[null==e.sessions?s("md-empty-state",{attrs:{"md-rounded":"","md-icon":"warning","md-label":"Failed to load rooms","md-description":"Are you logged in? Is the server running and available?"}}):s("div",[null==e.selected_session?s("div",[s("md-field",[s("label",[e._v("New Room Name")]),s("md-input",{model:{value:e.new_room_name,callback:function(t){e.new_room_name=t},expression:"new_room_name"}}),s("md-button",{on:{click:e.createAndJoinSession}},[s("md-icon",[e._v("create")]),e._v("Create & Join new Room")],1),s("md-button",{on:{click:e.getSessions}},[s("md-icon",[e._v("refresh")]),e._v(" Refresh")],1)],1),e._l(e.sessions,(function(t,n){return s("div",{key:n,staticClass:"flex-container"},[s("session-display",{staticClass:"session-display-card",attrs:{data:t,join_session:e.joinSession,delete_Session:e.deleteSession}})],1)}))],2):s("div",[s("play-room",{attrs:{session_name:e.selected_session}},[s("md-button",{staticClass:"md-raised md-primary",on:{click:function(t){e.selected_session=null}}},[s("md-icon",[e._v("exit_to_app")]),e._v(" Exit")],1)],1)],1)])],1)},i=[],a=s("56d7"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"room-card"},[s("div",{staticClass:"disable_selection "},[s("md-header",[s("div",{staticClass:"md-title"},[e._v(e._s(e.data.session_id))]),s("div",{staticClass:"md-subhead"},[e._v(e._s(e.data.created_at))])]),e.data.has_started?s("md-content",[e._v(" Game has started, last update: "+e._s(e.data.updated_at)+" ")]):e._e(),s("md-button",{on:{click:function(t){return e.join_session(e.data.session_id)}}},[e._v("Join")]),s("md-button",{staticClass:"md-accent",on:{click:function(t){return e.delete_Session(e.data.session_id)}}},[s("md-icon",[e._v("delete")]),e._v("Delete")],1)],1)])},o=[],c={data:function(){return{}},components:{},props:{data:{required:!0},join_session:{type:Function,required:!0},delete_Session:{type:Function,required:!0}}},d=c,u=(s("df08"),s("2877")),l=Object(u["a"])(d,r,o,!1,null,"fa6650ca",null),_=l.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[null!==e.session_data&&null!==e.session_data.last_round.session.session_id?s("md-app",[s("md-app-toolbar",{staticClass:"md-primary flex-row-view"},[s("span",{staticClass:"md-title"},[e._v(" Room ["+e._s(e.session_data.last_round.session.session_id)+"], round : #"+e._s(e.session_data.last_round.roundNumber)+" with "+e._s(e.number_of_players)+" player ")]),e._t("default")],2),s("md-app-content",[e.session_data.has_started?e.session_data.has_started&&!e.has_player_submitted?s("div",[s("during-game-round-view",{attrs:{active_round:e.session_data.last_round,profile_data:e.session_data.players.profiles,update_player_data:e.update_player_data,current_player_data:e.current_player_data,submit_cards:e.submit_cards}})],1):e.session_data.has_started&&e.has_player_submitted?s("div",[s("submission-round-view",{attrs:{submissions:e.submissions_by_everyone,session_data:e.session_data,profile_data_all_players:e.players,current_player_data:e.current_player_data,select_winner:e.select_winner}})],1):e._e():s("div",[s("waiting-for-start-view",{attrs:{session_name:e.session_name,players_in_session:e.players,step_game:e.step_game}})],1)])],1):e._e(),s("md-button",{on:{click:function(t){return e.session_data_update()}}},[e._v(" Click")]),s("md-button",{on:{click:function(t){return e.connect_to_socket()}}},[e._v("Websocket")]),s("md-dialog-alert",{attrs:{"md-title":e.dialog.title,"md-active":e.dialog.active,"md-content":e.dialog.content,"md-confirm-text":"Cool!"},on:{"update:mdActive":function(t){return e.$set(e.dialog,"active",t)},"update:md-active":function(t){return e.$set(e.dialog,"active",t)}}})],1)},p=[],f=(s("4de4"),s("a15b"),s("d81d"),s("ac1f"),s("1276"),s("2ca0"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.players_in_session?s("div",[s("span",[e._v(" The following players in waiting for the game to start: "+e._s(e.player_in_lobby)+" ")]),s("br"),s("md-button",{staticClass:"md-raised",on:{click:function(t){return e.step_game()}}},[e._v("I have waited enough! Let's start")])],1):s("div",[s("md-progress-spinner",{attrs:{"md-diameter":100,"md-stroke":10,"md-mode":"indeterminate"}})],1)])}),b=[],h={props:{session_name:{type:String,required:!0},players_in_session:{required:!0},step_game:{required:!0,type:Function}},methods:{},computed:{player_in_lobby:function(){return this.players_in_session?this.players_in_session.map((function(e){return e.user})):""}}},v=h,y=Object(u["a"])(v,f,b,!1,null,null,null),g=y.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-container"},[null==e.current_player_data?s("div",[e._v(" loading.. ")]):e._e(),e.profile_data?s("div",[s("ul",{staticClass:"flex-container"},e._l(e.profile_data,(function(t,n){return s("div",{key:n},[s("player-display",{attrs:{player_data:t,is_tzar:e.isTzar(t)}})],1)})),0)]):e._e(),s("black-card-display",{attrs:{card_data:e.active_round.active_black_card}}),s("div",[e.submissions.length>0?s("ul",{staticClass:"table-container"},[e._v(" Selected cards: "),e._l(e.submissions,(function(t,n){return s("div",{key:n},[s("white-card-display",{attrs:{card_data:t,on_clicked_callback:e.remove_card_from_submission}})],1)}))],2):e._e()]),e.active_round.active_black_card.pick!=e.submissions.length?s("div",[e._v(" You have to select more cards before you can submit it! ")]):s("md-button",{staticClass:"md-raised",on:{click:function(t){return e.submit_cards(e.submissions)}}},[e._v("Submit Selected")]),s("div",[s("ul",{staticClass:"flex-container table-container"},e._l(e.cards_to_display,(function(t,n){return s("div",{key:n},[s("white-card-display",{attrs:{card_data:t,on_clicked_callback:e.on_white_card_clicked}})],1)})),0)])],1)},w=[],S=(s("caad"),s("2532"),s("a019")),x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"disable_selection"},[s("md-card",{staticClass:"player_card",attrs:{"md-with-hover":""}},[s("md-card-header",[s("md-card-header-text",[s("div",{staticClass:"md-title"},[e._v(e._s(e.displayed_name))]),e.is_tzar?s("div",{staticClass:"md-subhead"},[e._v(" TZAR "),s("md-icon",[e._v("star_rate")])],1):e._e()]),s("md-card-media",[s("img",{attrs:{src:"https://cdn.pixabay.com/photo/2016/03/31/19/58/avatar-1295430_1280.png",alt:"Player"}})])],1)],1)],1)},A=[],C={data:function(){return{}},components:{},props:{player_data:{required:!0},is_tzar:{default:!1}},computed:{displayed_name:function(){return this.player_data.user.substring(0,15)}}},E=C,N=(s("7e1d"),Object(u["a"])(E,x,A,!1,null,"8658a2a6",null)),O=N.exports,I=s("36e5"),T={data:function(){return{submissions:[]}},props:{active_round:{type:Object,required:!0},profile_data:{type:Array,required:!0},update_player_data:{required:!0,type:Function},submit_cards:{required:!0,type:Function},current_player_data:{type:Object,required:!0}},components:{"black-card-display":S["a"],"player-display":O,"white-card-display":I["a"]},computed:{
//!TODO: Actual metric about how many players need to submit something.
submission_counter_text:function(){return"0/1"},
//! Display only cards that are not submitted
cards_to_display:function(){var e=this;return this.current_player_data?this.current_player_data.cards.filter((function(t){return!e.submissions.includes(t)})):[]}},mounted:function(){this.update_player_data()},methods:{
//! Shortcut function to check if the given player is the Tzar
isTzar:function(e){return e.user==this.active_round.tzar.user},
//! Execute this callback when a white card instance is clicked.
//! Add to submissions if not submitted, remove from submission if submitted.
on_white_card_clicked:function(e){if(this.submissions.includes(e))this.remove_card_from_submission(e);else{if(this.submissions.length+1>this.active_round.active_black_card.pick)return this.$store.commit("push_message_to_snackbar","You cannot submit more cards than the allowed pick count"),!1;this.submissions.push(e)}return!0},remove_card_from_submission:function(e){this.submissions=this.submissions.filter((function(t,s,n){return t.text!=e.text}))}}},q=T,$=(s("b76d"),Object(u["a"])(q,k,w,!1,null,"9ad521f6",null)),R=$.exports,j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._v(" You are currently looking at the submission view. The TZAR ("+e._s(e.session_data.last_round.tzar.user)+") is currently selecting the winner card. "),e.has_everyone_submitted?e._e():s("div",[e._v(" Waiting for every player to submit ")]),e.submissions.length>0?s("ul",e._l(e.submissions,(function(t,n){return s("md-list",{key:n},[s("md-list-item",[s("submission-display",{staticClass:"md-list-item-text",attrs:{submission_info:t,black_card_data:e.session_data.last_round.active_black_card}},[e.current_player_data.isTzar&&e.has_everyone_submitted?s("div",[s("md-button",{on:{click:function(s){return e.select_winner(t.submission_id)}}},[e._v("This is the best!")])],1):e._e()])],1)],1)})),1):e._e()])},L=[],F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"submitted-display"},[s("md-content",{staticClass:"submission_content"},[e._v(" "+e._s(e.submitted_content)+" "),s("p",[e._v(" Submitted by "+e._s(e.submission_info.connected_game_round_profile.user_profile.user)+" ")]),e._t("default")],2)],1)},J=[],z=(s("c975"),s("a9e3"),{props:{submission_info:{submitted_white_cards:{required:!0,type:Array},submission_id:{required:!0,type:Number}},black_card_data:{required:!0}},methods:{replace_character_at_index:function(e,t,s){return e.substring(0,t)+s+e.substring(t+1,e.length)}},computed:{submitted_content:function(){var e=this.black_card_data.text;if(-1==e.indexOf("_"))return e+" ["+this.submission_info.submitted_white_cards[0].text+"]";var t=this.submission_info.submitted_white_cards.map((function(e){return e.text})),s=0;while(-1!=e.indexOf("_")){var n=e.indexOf("_");e=this.replace_character_at_index(e,n,"["+t[s]+"]"),s+=1}return e}}}),P=z,W=(s("4598"),Object(u["a"])(P,F,J,!1,null,"23e37c9e",null)),M=W.exports,D={components:{"submission-display":M},props:{submissions:{required:!0},session_data:{required:!0},profile_data_all_players:{required:!0},current_player_data:{required:!0},select_winner:{required:!0,type:Function}},computed:{has_everyone_submitted:function(){return this.submissions.length>=this.profile_data_all_players.length}}},U=D,V=Object(u["a"])(U,j,L,!1,null,null,null),Y=V.exports,G={data:function(){return{display:"",session_data:null,profile_data:null,current_player_data:null,submissions_by_everyone:[],has_player_submitted:!1,dialog:{title:"",active:!1,content:"lofasz"}}},components:{"waiting-for-start-view":g,"during-game-round-view":R,"submission-round-view":Y},props:{session_name:{required:!0}},mounted:function(){this.session_data_update(),this.$store.commit("register_on_message_callback",this.on_new_message),this.connect_to_socket()},methods:{connect_to_socket:function(){a["backendSocket"].$connect("ws://"+window.location.hostname+":8000/ws/chat/user/"+this.session_name+"/?token="+this.$store.state.api_token)},step_game:function(){a["backendSocket"].$socket.send(JSON.stringify({message:"step"})),this.session_data_update()},on_new_message:function(e){"UPDATE"===e?this.session_data_update():"REQUEST_PLAYER_DATA"===e?this.update_player_data():e.startsWith("__DECLARE_WINNER__")?(console.log("Winner has been declared!"),this.dialog.content="Winner has been selected! IT is : "+e.split("__|")[1]+"<br>NEXT ROUND STARTS!",this.dialog.active=!0):(console.log("Unhandled message: "+e),console.log(e))},session_data_update:function(){var e=this,t=this.session_name;a["gameApi"].gameEngineApiSessionViewList(t,(function(t,s,n){t?(console.error("session_data_update-gameEngineApiSessionViewList returned with error"),console.error(t)):(console.log("API called successfully. Returned data: "+n),e.session_data=n.body,e.submissions=e.session_data.submissions,e.update_has_player_submitted(),e.update_submissions_by_other_players())}))},remove_card_from_submission:function(e){this.submissions=this.submissions.filter((function(t,s,n){return t.text!=e.text}))},update_player_data:function(){var e=this,t=this.session_name,s={};a["gameApi"].gameEngineApiSessionProfilesList(t,s,(function(s,n,i){s?console.error(s):(console.log("API called successfully. Returned data: "+i),e.profile_data=JSON.parse(i.text).results,a["gameApi"].gameEngineApiSessionMycardsList(t,(function(t,s,n){t?(console.error("update_player_data - gameEngineApiSessionMycardsList returned with error "),console.error(t)):(console.log("Fetching player data called successfully. Returned data: "+n),e.current_player_data=n.body)})))}))},update_submissions_by_other_players:function(){var e=this,t=this.session_name,s={};a["gameApi"].gameEngineApiSessionSubmissionsList(t,s,(function(t,s,n){console.log("Returned.."),t?(console.error("gameEngineApiSessionSubmissionsList"),console.error(t)):(console.log("gameEngineApiSessionSubmissionsList successfully returned data: "+n),e.submissions_by_everyone=JSON.parse(n.text).results)}))},update_has_player_submitted:function(){var e=this,t=this.session_name;a["gameApi"].gameEngineApiSessionHasPlayerSubmittedList(t,(function(t,s,n){t?e.has_player_submitted=!1:(console.log(n),e.has_player_submitted=!0)}))},submit_cards:function(e){var t="__submit__|",s=e.map((function(e){return e.text}));a["backendSocket"].$socket.send(JSON.stringify({message:t+s.join("|")}))},select_winner:function(e){var t="__selectwinner__|"+e;a["backendSocket"].$socket.send(JSON.stringify({message:t})),this.step_game()},isTzar:function(e){return e.user==this.session_data.last_round.tzar.user}},destroyed:function(){console.log("PlayRoom destroyed"),this.$store.commit("register_on_message_callback",null),a["backendSocket"].$disconnect()},computed:{submit_command:function(){var e="__submit__|",t=this.submissions.map((function(e){return e.text}));return e+t.join("|")},white_card_submissions_by_everyone:function(){return this.submissions_by_everyone},players:function(){return this.session_data?(console.log("Returnign profiles!"),console.warn(this.session_data.players.profiles),this.session_data.players.profiles):null},number_of_players:function(){return this.players.length}}},X=G,H=(s("57e7"),Object(u["a"])(X,m,p,!1,null,"658fccea",null)),Z=H.exports,K={name:"Home",data:function(){return{sessions:null,selected_session:null,new_room_name:null}},components:{"session-display":_,"play-room":Z},methods:{getSessions:function(){var e=this,t={search:"",page:1};a["gameApi"].gameEngineApiSessionsList(t,(function(t,s,n){if(t)console.error(t);else{var i=JSON.parse(n.text).results;e.sessions=i}}))},joinSession:function(e){this.selected_session=e},createAndJoinSession:function(){this.joinSession(this.new_room_name)},deleteSession:function(e){var t=this;a["gameApi"].gameEngineApiSessionsDelete(e,(function(s,n,i){s?t.$store.commit("push_message_to_snackbar","Failed to delete session : "+e+", "+i.text):(t.$store.commit("push_message_to_snackbar","Session : "+e+" deleted, "+i.text),t.getSessions())}))}},mounted:function(){this.getSessions()}},Q=K,B=(s("9df6"),Object(u["a"])(Q,n,i,!1,null,"170c55f9",null));t["default"]=B.exports},4598:function(e,t,s){"use strict";var n=s("c133"),i=s.n(n);i.a},"4c1c":function(e,t,s){},"4de4":function(e,t,s){"use strict";var n=s("23e7"),i=s("b727").filter,a=s("1dde"),r=s("ae40"),o=a("filter"),c=r("filter");n({target:"Array",proto:!0,forced:!o||!c},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},5696:function(e,t,s){},"57e7":function(e,t,s){"use strict";var n=s("a203"),i=s.n(n);i.a},7156:function(e,t,s){var n=s("861d"),i=s("d2bb");e.exports=function(e,t,s){var a,r;return i&&"function"==typeof(a=t.constructor)&&a!==s&&n(r=a.prototype)&&r!==s.prototype&&i(e,r),e}},"7ce2":function(e,t,s){"use strict";var n=s("ed44"),i=s.n(n);i.a},"7e1d":function(e,t,s){"use strict";var n=s("4c1c"),i=s.n(n);i.a},"7e34":function(e,t,s){"use strict";var n=s("0eeb"),i=s.n(n);i.a},"9df6":function(e,t,s){"use strict";var n=s("a4a1"),i=s.n(n);i.a},a019:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"disable_selection"},[s("md-card",{staticClass:"black-card",attrs:{"md-with-hover":""}},[s("div",{staticClass:"md-title"},[e._v(e._s(e.displayedText))]),s("div",{staticClass:"md-subhead evenly-spaced"},[s("span",[e._v(e._s(e.card_data.icon)+" ")]),s("span",[e._v(e._s(e.card_data.deck))]),s("div",[e._v(" PICK "),s("span",{staticClass:"dot pick-counter"},[e._v(" "+e._s(e.card_data.pick))])])])])],1)},i=[],a=(s("ac1f"),s("5319"),{data:function(){return{}},components:{},props:{card_data:{required:!0}},computed:{displayedText:function(){return this.card_data.text.replace("_","_____")}}}),r=a,o=(s("7ce2"),s("2877")),c=Object(o["a"])(r,n,i,!1,null,"38f7dabe",null);t["a"]=c.exports},a203:function(e,t,s){},a4a1:function(e,t,s){},a9e3:function(e,t,s){"use strict";var n=s("83ab"),i=s("da84"),a=s("94ca"),r=s("6eeb"),o=s("5135"),c=s("c6b6"),d=s("7156"),u=s("c04e"),l=s("d039"),_=s("7c73"),m=s("241c").f,p=s("06cf").f,f=s("9bf2").f,b=s("58a8").trim,h="Number",v=i[h],y=v.prototype,g=c(_(y))==h,k=function(e){var t,s,n,i,a,r,o,c,d=u(e,!1);if("string"==typeof d&&d.length>2)if(d=b(d),t=d.charCodeAt(0),43===t||45===t){if(s=d.charCodeAt(2),88===s||120===s)return NaN}else if(48===t){switch(d.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+d}for(a=d.slice(2),r=a.length,o=0;o<r;o++)if(c=a.charCodeAt(o),c<48||c>i)return NaN;return parseInt(a,n)}return+d};if(a(h,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var w,S=function(e){var t=arguments.length<1?0:e,s=this;return s instanceof S&&(g?l((function(){y.valueOf.call(s)})):c(s)!=h)?d(new v(k(t)),s,S):k(t)},x=n?m(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;x.length>A;A++)o(v,w=x[A])&&!o(S,w)&&f(S,w,p(v,w));S.prototype=y,y.constructor=S,r(i,h,S)}},b5f4:function(e,t,s){},b76d:function(e,t,s){"use strict";var n=s("5696"),i=s.n(n);i.a},c133:function(e,t,s){},c975:function(e,t,s){"use strict";var n=s("23e7"),i=s("4d64").indexOf,a=s("a640"),r=s("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,d=a("indexOf"),u=r("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:c||!d||!u},{indexOf:function(e){return c?o.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},df08:function(e,t,s){"use strict";var n=s("b5f4"),i=s.n(n);i.a},ed44:function(e,t,s){}}]);
//# sourceMappingURL=chunk-32c48db0.28946fbf.js.map